import{g as t}from"./config-BvOGzWpZ.js";import"./auth-BxmWGv8U.js";document.addEventListener("alpine:init",()=>{Alpine.data("kutiData",()=>({kutis:[],showKutiModal:!1,showConfirmModal:!1,isEditing:!1,currentKuti:{id:null,code:"",gender_allowed:"All",is_available:!0,note:""},isLoading:!0,showNotification:!1,notificationMessage:"",notificationType:"success",init(){this.fetchKutis()},async fetchKutis(){try{this.isLoading=!0;const i=localStorage.getItem("access_token"),s=await fetch(t("/api/kuti/"),{headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Lỗi khi tải danh sách Kuti");this.kutis=await s.json()}catch(i){console.error("Error:",i),this.showNotificationMessage(i.message,"error")}finally{this.isLoading=!1}},openAddKutiModal(){this.isEditing=!1,this.currentKuti={id:null,code:"",gender_allowed:"All",is_available:!0,note:""},this.showKutiModal=!0},openEditKutiModal(t){this.isEditing=!0,this.currentKuti={...t},this.showKutiModal=!0},closeKutiModal(){this.showKutiModal=!1},validateKutiForm(){return!!this.currentKuti.code.trim()||(this.showNotificationMessage("Vui lòng nhập mã Kuti","error"),!1)},async saveKuti(){if(this.validateKutiForm())try{const i=this.isEditing?t(`/api/kuti/${this.currentKuti.id}/`):t("/api/kuti/"),s=this.isEditing?"PUT":"POST",o=localStorage.getItem("access_token"),e=await fetch(i,{method:s,headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(this.currentKuti)});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.message||(this.isEditing?"Cập nhật thất bại":"Thêm mới thất bại"))}this.showNotificationMessage(this.isEditing?"Cập nhật Kuti thành công":"Thêm Kuti mới thành công","success"),this.showKutiModal=!1,await this.fetchKutis()}catch(i){console.error("Error:",i),this.showNotificationMessage(i.message,"error")}},confirmDelete(t){this.currentKuti={...t},this.showConfirmModal=!0},async deleteKuti(){try{const i=localStorage.getItem("access_token"),s=await fetch(t(`/api/kuti/${this.currentKuti.id}/`),{headers:{Authorization:`Bearer ${i}`},method:"DELETE"});if(!s.ok){const t=await s.json().catch(()=>({}));throw new Error(t.message||"Xóa Kuti thất bại")}this.showNotificationMessage("Xóa Kuti thành công","success"),this.showConfirmModal=!1,await this.fetchKutis()}catch(i){console.error("Error:",i),this.showNotificationMessage(i.message,"error")}},formatDate(t){if(!t)return"N/A";return new Date(t).toLocaleDateString("vi-VN")},showNotificationMessage(t,i="success"){this.notificationMessage=t,this.notificationType=i,this.showNotification=!0,setTimeout(()=>{this.showNotification=!1},3e3)}}))});
