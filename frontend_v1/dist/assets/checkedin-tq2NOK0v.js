import{g as t}from"./config-BvOGzWpZ.js";/* empty css             */import"./auth-BxmWGv8U.js";document.addEventListener("alpine:init",()=>{Alpine.data("checkedInData",()=>({registrations:[],filteredRegistrations:[],searchQuery:"",showDetail:!1,selectedRegistration:null,isLoading:!0,showNotification:!1,notificationMessage:"",notificationType:"success",init(){this.fetchRegistrations()},async fetchRegistrations(){try{this.isLoading=!0;const e=await fetch(t("/api/registration/"));if(!e.ok)throw new Error("Lỗi kết nối mạng");const i=await e.json();this.registrations=i.filter(t=>"checked_in"===t.status),this.filteredRegistrations=[...this.registrations]}catch(e){console.error("Lỗi khi tải danh sách đăng ký:",e),this.showNotificationMessage("Có lỗi xảy ra khi tải dữ liệu","error")}finally{this.isLoading=!1}},calculateDuration(t,e){if(!t||!e)return 0;const i=new Date(t),s=new Date(e),o=Math.abs(s-i);return Math.ceil(o/864e5)},calculateRemainingDays(t){if(!t)return"N/A";const e=new Date,i=new Date(t)-e,s=Math.ceil(i/864e5);return s<0?"Đã hết hạn":0===s?"Hôm nay":`${s} ngày`},formatDate(t){if(!t)return"N/A";return new Date(t).toLocaleDateString("vi-VN")},formatStatus:t=>({approved:{text:"Đã duyệt",color:"bg-green-100 text-green-800"},checked_in:{text:"Đã check-in",color:"bg-purple-100 text-purple-800"},checked_out:{text:"Đã check-out",color:"bg-orange-100 text-orange-800"}}[t]||{text:t,color:"bg-gray-100 text-gray-800"}),filterRegistrations(){if(!this.searchQuery)return void(this.filteredRegistrations=[...this.registrations]);const t=this.searchQuery.toLowerCase();this.filteredRegistrations=this.registrations.filter(e=>e.fullname.toLowerCase().includes(t)||e.username.includes(t)||e.cccd&&e.cccd.includes(t)||e.address&&e.address.toLowerCase().includes(t))},showNotificationMessage(t,e="success"){this.notificationMessage=t,this.notificationType=e,this.showNotification=!0,setTimeout(()=>{this.showNotification=!1},3e3)},showRegistrationDetail(t){this.selectedRegistration=t,this.showDetail=!0},async checkoutRegistration(e){try{const i=localStorage.getItem("access_token");if(!(await fetch(t(`/api/registration/${e}/checkout/`),{method:"PUT",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}})).ok)throw new Error("Check-out thất bại");this.showNotificationMessage("Check-out thành công","success"),this.fetchRegistrations()}catch(i){console.error("Lỗi check-out:",i),this.showNotificationMessage("Có lỗi xảy ra khi check-out","error")}},downloadTemporaryStay(t){console.log("Tải file tạm trú cho ID:",t),this.showNotificationMessage("Đang tải file tạm trú...","success")}}))});
